# MySQL/MariaDB Master Replication Configuration
# Generated by Ansible on {{ ansible_date_time.iso8601 }}

[mysqld]
# Server identification
server-id = {{ server_id | default(1) }}

# Binary logging
log-bin = mysql-bin
log-bin-index = mysql-bin.index
binlog_format = ROW
binlog_do_db = {{ powerdns_db_name }}

# Replication settings
sync_binlog = 1
innodb_flush_log_at_trx_commit = 1

# GTID settings (for MySQL 5.6+)
gtid_mode = ON
enforce_gtid_consistency = ON
log_slave_updates = ON

# Performance settings for replication
max_binlog_size = 100M
expire_logs_days = {{ mysql_binlog_retention_days | default(7) }}

# Network settings
bind-address = {{ ansible_default_ipv4.address }}

# Replication user settings
# Note: User creation is handled in tasks, not here
