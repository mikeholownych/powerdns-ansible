# Log rotation for AIDE logs
# Generated by Ansible on {{ ansible_date_time.iso8601 }}

/var/log/aide/*.log {
    daily
    missingok
    rotate 30
    compress
    delaycompress
    notifempty
    create 0640 root root
    postrotate
        # No service restart needed for AIDE logs
    endscript
}

/var/log/aide/aide-check.log {
    weekly
    missingok
    rotate 12
    compress
    delaycompress
    notifempty
    create 0640 root root
    size 10M
}

/var/log/aide/aide-update.log {
    monthly
    missingok
    rotate 6
    compress
    delaycompress
    notifempty
    create 0640 root root
    size 5M
}

# AIDE reports (keep compressed for longer)
/var/log/aide/aide-report-*.log {
    weekly
    missingok
    rotate 52
    compress
    delaycompress
    notifempty
    create 0640 root root
    maxage 365
}
