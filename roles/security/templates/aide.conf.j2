# AIDE Configuration for PowerDNS Security Monitoring
# Generated by Ansible on {{ ansible_date_time.iso8601 }}

# Database and report locations
database=file:/var/lib/aide/aide.db
database_out=file:/var/lib/aide/aide.db.new
gzip_dbout=yes

# Report settings
verbose=5
report_url=file:/var/log/aide/aide.log
report_url=stdout

# Define what to check
# p = permissions, i = inode, n = number of links, u = user, g = group
# s = size, b = block count, m = mtime, a = atime, c = ctime, S = check for growing size
# md5 = md5 checksum, sha1 = sha1 checksum, sha256 = sha256 checksum, rmd160 = rmd160 checksum
# tiger = tiger checksum, haval = haval checksum, crc32 = crc32 checksum
# R = p+i+n+u+g+s+m+c+md5
# L = p+i+n+u+g
# E = Empty group
# > = Growing logfile p+u+g+i+n+S

# Define groups
Binlib = p+i+n+u+g+s+b+m+c+md5+sha256
ConfFiles = p+i+n+u+g+s+b+m+c+md5+sha256
Logs = p+i+n+u+g+S
Databases = p+i+n+u+g+s+b+m+c+md5+sha256
StaticDir = p+i+n+u+g
Growing = p+i+n+u+g+s+b+m+c+md5+sha256

# System binaries and libraries
/bin Binlib
/sbin Binlib
/usr/bin Binlib
/usr/sbin Binlib
/usr/local/bin Binlib
/usr/local/sbin Binlib
/lib Binlib
/lib64 Binlib
/usr/lib Binlib
/usr/lib64 Binlib
/usr/local/lib Binlib

# Configuration files
/etc ConfFiles

# PowerDNS specific files
{{ powerdns_config_dir }} ConfFiles
{{ powerdns_backup_dir }} Databases

# System configuration
/boot ConfFiles

# Critical system files
/root ConfFiles

# SSH configuration
/etc/ssh ConfFiles

# Cron jobs
/etc/cron.d ConfFiles
/etc/cron.daily ConfFiles
/etc/cron.hourly ConfFiles
/etc/cron.monthly ConfFiles
/etc/cron.weekly ConfFiles
/var/spool/cron ConfFiles

# Log files (growing)
/var/log Logs

# Temporary and variable directories (exclude)
!/tmp
!/var/tmp
!/proc
!/sys
!/dev
!/run
!/var/run
!/var/lock
!/var/cache
!/var/spool/postfix

# Database files
/var/lib/mysql Databases
/var/lib/powerdns Databases

# Exclude frequently changing files
!/var/log/aide
!/var/lib/aide/aide.db
!/var/lib/aide/aide.db.new
!/etc/mtab
!/etc/resolv.conf
!/etc/adjtime
!/var/lib/dhcp
!/var/lib/dhclient

# Monitoring directories
/var/log/monitoring Logs
/opt/monitoring ConfFiles

# Backup directories
{{ powerdns_backup_dir }} Growing

# Custom rules for PowerDNS
{{ powerdns_config_file }} ConfFiles

# MySQL/MariaDB configuration
/etc/mysql ConfFiles
/etc/my.cnf ConfFiles
/etc/my.cnf.d ConfFiles

# Security tools configuration
/etc/fail2ban ConfFiles
/etc/aide ConfFiles

# Firewall configuration
/etc/ufw ConfFiles
/etc/firewalld ConfFiles

# Systemd services
/etc/systemd/system ConfFiles
/usr/lib/systemd/system ConfFiles

# Certificate directories
/etc/ssl ConfFiles
/etc/pki ConfFiles

# Package manager databases
/var/lib/rpm Databases
/var/lib/dpkg Databases
/var/lib/apt Databases
